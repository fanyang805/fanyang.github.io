<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Fan's site | Full SLAM with FastSLAM Algorithm</title>
<meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design.
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" />

<!-- Styles -->
<!-- 
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22></text></svg>">
 -->
<!-- <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22></text></svg>"> -->
<link rel="shortcut icon" href="/assets/img/favicon.ico">
<link rel="stylesheet" href="/assets/css/main.css">

<link rel="canonical" href="/projects/SLAM/Fast-slam/">

<!-- JQuery -->
<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>


<!-- Theming-->

  <script src="/assets/js/theme.js"></script>
  <!-- Load DarkMode JS -->
<script src="/assets/js/dark_mode.js"></script>






    
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  </head>

  <body class="fixed-top-nav sticky-bottom-footer">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="/">
        <i class="fas fa-fan fa-spin"></i>
       Fan's site
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              About
              
            </a>
          </li>
          
          <!-- Blog -->
          <li class="nav-item ">
            <a class="nav-link" href="/blog/">
              Blog 
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/course-work/">
                Course Work
                
              </a>
          </li>
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/projects/">
                Projects
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/publications/">
                Publications
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/research/">
                Research
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/services/">
                Services
                
              </a>
          </li>
          
          
          
          
          
            <div class = "toggle-container">
              <a id = "light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
              </a>
            </div>
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      <div class="post">

  <header class="post-header">
    <h1 class="post-title">Full SLAM with FastSLAM Algorithm</h1>
    <!-- <p class="post-description">This project implements FastSLAM for full SLAM problem. Unlike the online SLAM algorithms such as EKF that computes the posterior in the current time step, FastSLAM estimates the full path posterior and the locations of features given the range-bearing sensor reading and odometry information. 
</p> -->
  </header>

  <article>
    <p>The FastSLAM algorithm implemented in this project solves the full SLAM problem. It uses particle filters for estimating the robot path while each particle (which is a hypothesis of robot pose) uses separate EKFs to estimate each map feature location, based on the conditional independence between any two disjoint sets of features in the map, given the robot pose. The particle in FastSLAM is denoted as</p>

\[\langle x_t^{[k]}, \mu_{1,t}^{[k]}, \Sigma_{1,t}^{[k]}, ..., \mu_{N,t}^{[k]}, \Sigma_{N,t}^{[k]} \rangle\]

<p>where \(k\) is the index of the particle, \(\mu_{i,t}^{[k]}, \Sigma_{i,t}^{[k]}\) refer to the mean and covariance of the i-th map feature.</p>

<p>The advantage of FastSLAM is</p>

<ol>
  <li>
    <p>The data association decision can be made on a per-particle basis. The FastSLAM maintains multiple data associations, in contrast to EKF that tracks only one at any time step</p>
  </li>
  <li>
    <p>The particle filter used in FastSLAM allows the algorithm to deal with the highly nonlinear motion models.</p>
  </li>
</ol>
<div class="row justify-content-center">
      <div class="col">
        <div class="w-50 mx-auto" style="background-color: white;">
            <img class="img-fluid" src="/projects/SLAM/Fast-slam/assets/img/fastslam.gif" alt="" />
        </div>
      </div>
  </div>
<div class="caption">
  Full SLAM by FastSLAM algorithm
  </div>

<p>The particles with the highest weight are in red color. The arrow refers to the current pose of the particle with the highest weight. All other particles are in gray color (some of paths may be disappear because of the resampling step). The blue crosses represent the ground-true position of the landmarks. The blue dots represent the estimated landmark positions of each particle. The ellipse is the error ellipse of estimated landmark positions of the particle with the highest weight.</p>

<h2 id="fastslam-overview">FastSLAM Overview</h2>

<p>The full SLAM problem considered in this project can be written as a posterior:</p>

<p>\(P(x_{0:t},m_{1:N}|z_{1:t},u_{1:t}) = P(x_{0:t}|z_{1:t},u_{1:t}) P(m_{1:N}|x_{0:t},z_{1:t})\).</p>

<p>Based on the conditionally independence of the landmarks given the poses, the latter posterior on the right hand side can be further written as</p>

\[\prod_{i=1}^{N} P(m_i|x_{0:t},z_{1:t})\]

<p>Therefore the full SLAM posterior is equivalent to:</p>

\[P(x_{0:t},m_{1:N}|z_{1:t},u_{1:t}) = P(x_{0:t}|z_{1:t},u_{1:t})\prod_{i=1}^{N} P(m_i|x_{0:t},z_{1:t})\]

<p>The path posterior can be represented by a set of the particles while each particle maintains separate map posterior by EKF, i.e.,</p>

\[\langle x_t^{[k]}, \mu_{1,t}^{[k]}, \Sigma_{1,t}^{[k]}, ..., \mu_{N,t}^{[k]}, \Sigma_{N,t}^{[k]} \rangle\]

<p>The key steps of FastSLAM are following:</p>

<ol>
  <li>
    <p>Prediction: Extend the path posterior by sampling a new pose for each particle, based on the motion model (odometry motion model in this project).</p>

\[x_t^{[k]} \sim P(x_t|x_{t-1}^{[k]}, u_t), \ \forall k = 1, ..., N.\]
  </li>
  <li>
    <p>Measurement update: Update belief of each observed landmark by EKF, compute measurement predication by</p>

\[\hat{z}^{[k]} = h(\mu^{[k]}_{j,t-1}, x_t^{[k]})\]
  </li>
  <li>
    <p>Compute the particle weight by</p>

\[w^{[k]} = |2\pi Q|^{-\frac{1}{2}} \exp{(-\frac{1}{2}(z_t - \hat{z}^{[k]})^T Q^{-1} (z_t-\hat{z}^{[k]}))}\]
  </li>
</ol>

<p>The detailed algorithm is presented in the pseudocode<sup>[2]</sup> below.</p>
<div class="row justify-content-center">
    <div class="col">
        <div class="w-50 mx-auto" style="background-color: white;">
            <img class="img-fluid" src="/projects/SLAM/Fast-slam/assets/img/fast-slam.png" alt="" />
        </div>
    </div>
</div>
<div class="caption">
The FastSLAM 1.0 
</div>
<p><br /></p>

<h2 id="code-explanation">Code Explanation</h2>

<ol>
  <li>
    <p><code class="language-plaintext highlighter-rouge">sample_motion_model(odometry, particles)</code>: Sample a new pose for each particle by the odometry motion model. Implement line 3 to 4.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">measurement_model(particle, landmark)</code>: Compute the expected measurement for the given landmark and the Jacobian with respect to the landmark. Implement line 12 to 13.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">eval_sensor_model(sensor_data, particles)</code>: Update the estimate of the landmark position based on the range-bearing measurement<sup>[1]</sup> and compute the particle weight.</p>
  </li>
</ol>

<h3 id="references">References</h3>

<ol>
  <li>
    <p><strong>Introduction to Mobile Robotics</strong><br />
University of Freiburg, Spring, 2020, <a href="http://ais.informatik.uni-freiburg.de/teaching/ss20/robotics/index_en.php">http://ais.informatik.uni-freiburg.de/teaching/ss20/robotics/index_en.php</a></p>
  </li>
  <li>
    <p><strong>Probabilistic Robotics</strong><br />
S. Thrun, W. Burgard, and D. Fox. MIT Press, Cambridge, Mass., (2005)</p>
  </li>
</ol>

  </article>

</div>

    </div>

    <!-- Footer -->

    
<footer class="sticky-bottom mt-5">
  <div class="container">
    &copy; Copyright 2021 Fan  Yang.
    
    
    
    Last updated: November 25, 2021.
    
  </div>
</footer>



  </body>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/assets/js/mansory.js" type="text/javascript"></script>


  


<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>


</html>
