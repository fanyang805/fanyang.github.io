<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Fan's site | Online SLAM with Unscented Kalman Filter</title>
<meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design.
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" />

<!-- Styles -->
<!-- 
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22></text></svg>">
 -->
<!-- <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22></text></svg>"> -->
<link rel="shortcut icon" href="/assets/img/favicon.ico">
<link rel="stylesheet" href="/assets/css/main.css">

<link rel="canonical" href="/projects/SLAM/UKF-slam/">

<!-- JQuery -->
<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>


<!-- Theming-->

  <script src="/assets/js/theme.js"></script>
  <!-- Load DarkMode JS -->
<script src="/assets/js/dark_mode.js"></script>






    
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  </head>

  <body class="fixed-top-nav sticky-bottom-footer">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="/">
        <i class="fas fa-fan fa-spin"></i>
       Fan's site
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              About
              
            </a>
          </li>
          
          <!-- Blog -->
          <li class="nav-item ">
            <a class="nav-link" href="/blog/">
              Blog 
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/course-work/">
                Course Work
                
              </a>
          </li>
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/projects/">
                Projects
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/publications/">
                Publications
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/research/">
                Research
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/services/">
                Services
                
              </a>
          </li>
          
          
          
          
          
            <div class = "toggle-container">
              <a id = "light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
              </a>
            </div>
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      <div class="post">

  <header class="post-header">
    <h1 class="post-title">Online SLAM with Unscented Kalman Filter</h1>
    <!-- <p class="post-description">The idea of Unscented Kalman Filter is similar to EKF by linearizing the transformation of a Gaussian. UKF performs a stochastic linearization through the use of a weighted statistical linear regression process. This project impelements an UKF SLAM system. 
</p> -->
  </header>

  <article>
    <p>Generally speaking, the Kalman filters require linear motion model and sensor model to perform the transformation of Gaussian distribution. In EKF, the first order Taylor expansion is used to linearize the functions at the mean of the belief. An alternative linearization method, called unscented transform is used in the Unscented Kalman Filter. In particular, the UKF extracts a set of points with weights from the Gaussian and passes those points through the nonlinear function. The transformed Gaussian can be recovered from those returned points.</p>

<p>In this project, we implemented a UKF for the online SLAM problem. Similar to the EKF, given the sensor reading, odometry information and the data association<sup>[1]</sup>, the robot estimates the its pose (shown by the red covariance ellipse and bar), the position of map feastures (shown by the blue covariance ellipse) at each time step.</p>
<div class="row justify-content-center">
      <div class="col">
        <div class="w-50 mx-auto" style="background-color: white;">
            <img class="img-fluid" src="/projects/SLAM/UKF-slam/assets/img/ukf_slam.gif" alt="" />
        </div>
      </div>
  </div>
<div class="caption">
  Unscented Kalman Filter Algorithm for the Online SLAM Problem
  </div>
<h2 id="ukf-overview">UKF Overview</h2>

<p>The points extracted from a Gaussian is called the sigma points, denoted by \(\chi^{[i]}\) and weight \(w_m^{[i]}\) and \(w_c^{[i]}\). For a \(n\)-dimensional Gaussian with mean \(\mu\) and covariance \(\Sigma\), the sigma points are computed according to:</p>

\[\begin{equation*}
\begin{split}
\chi^{[0]} &amp;= \mu \\
\chi^{[i]} &amp;= \mu + (\sqrt{(n+\lambda)\Sigma})_i, \ &amp;\forall i = 1, ..., n \\
\chi^{[i]} &amp;= \mu - (\sqrt{(n+\lambda)\Sigma})_{i-n}, \ &amp;\forall i = n+1, ..., 2n \\
\end{split}
\end{equation*}\]

<p>where subscript \(i\) denotes the index of the column and \(\lambda\) is a scaling parameter.</p>

<p>The two weights for each sigma point is computed by:</p>

\[\begin{equation*}
\begin{split}
w^{[0]}_m &amp;= \frac{\lambda}{n+\lambda} \\
w^{[0]}_c &amp;= \frac{\lambda}{n+\lambda} + (1-\alpha^2+\beta) \\
w^{[i]}_m &amp;= w^{[i]}_c = \frac{1}{2(n+\lambda)}, \ \forall i = 1, ..., 2n.
\end{split}
\end{equation*}\]

<p>where \(w^{[i]}_m\) is used to recover the mean \(\mu\) while \(w^{[i]}_c\) is used to recover the covariance \(\Sigma\).</p>

<p>The the sigma points are passed to the nonlinear function say \(g(x)\), i.e.,</p>

\[\mathcal{Y}^{[i]} = g(\chi^{[i]})\]

<p>The transformed Gaussian distribution can be recovered from the returned sigma points \(\mathcal{Y}^{[i]}\).</p>

\[\begin{equation*}
\begin{split}
\mu' &amp;= \sum_{i=1}^{2n} w_m^{[i]} \mathcal{Y}^{[i]} \\
\Sigma' &amp;=\sum_{i=1}^{2n} w_c^{[i]}(\mathcal{Y}^{[i]} - \mu') (\mathcal{Y}^{[i]} - \mu')^T
\end{split}
\end{equation*}\]

<p>Using the transformation mentioned above, the predication step in EKF can be replaced by the sigma point propagation of the motion model. Similarily in correction step we can pass the obtained sigma points (of the predicted Gaussian) to the sensor model \(h(x)\), and recover the mean and covariance of the expected observation. The Kalman gain then can be computed from the covariance of the observation and the cross-covariance between state and observation. The detailed algorithm<sup>[2]</sup> is shown below:</p>
<div class="row justify-content-center">
    <div class="col">
        <div class="w-50 mx-auto" style="background-color: white;">
            <img class="img-fluid" src="/projects/SLAM/UKF-slam/assets/img/ukf-slam.png" alt="" />
        </div>
    </div>
</div>
<div class="caption">
The Unscented Kalman Filter for Online SLAM 
</div>
<p><br /></p>

<p>Note that \(S_t\) in line 9 is equivalent to 
\(H_t \bar{\Sigma}_t H_t^T + Q_t\) 
and 
\(\bar{\Sigma}_t^{x,z}\) in line 10 is equivalent to 
\(\bar{\Sigma}_t H_t^T\) in computing the Kalman gain in EKF, i.e.,
\(K_t = \bar{\Sigma}_t H_t^T (H_t \bar{\Sigma}_t H_t^T + Q_t)^{-1}\)</p>

<h2 id="code-explanation">Code Explanation</h2>

<ol>
  <li>
    <p><code class="language-plaintext highlighter-rouge">[mu, sigma, sigma_points] = prediction_step(mu, sigma, u)</code>: implement line 2 to 6 of the algorithm above, compute the mean and covariance of the state which includes the robotâ€™s pose and landmark positions.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">[mu, sigma, map] = correction_step(mu, sigma, z, map)</code>: implement the correction step from line 7 to 13 in UKF algorithm, update the mean and covariance of state after the range-bearing sensor measurement.</p>
  </li>
</ol>

<h3 id="references">References</h3>

<ol>
  <li>
    <p><strong>Robot Mapping</strong><br />
University of Freiburg, WS 2013/14, <a href="http://ais.informatik.uni-freiburg.de/teaching/ws13/mapping/">http://ais.informatik.uni-freiburg.de/teaching/ws13/mapping/</a></p>
  </li>
  <li>
    <p><strong>Probabilistic Robotics</strong><br />
S. Thrun, W. Burgard, and D. Fox. MIT Press, Cambridge, Mass., (2005)</p>
  </li>
</ol>

  </article>

</div>

    </div>

    <!-- Footer -->

    
<footer class="sticky-bottom mt-5">
  <div class="container">
    &copy; Copyright 2021 Fan  Yang.
    
    
    
    Last updated: November 25, 2021.
    
  </div>
</footer>



  </body>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/assets/js/mansory.js" type="text/javascript"></script>


  


<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>


</html>
